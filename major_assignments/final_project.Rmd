```{r}
library(tidyverse)
library(janitor)
```


```{r}
# load the  PxP data 
pbp_2023 <- read_csv ("~/Downloads/pbp_2023_d1.csv")
```
```{r}
pbp_2023 %>% 
  group_by(team,action) %>% 
  summarize(total = n())
```
```{r}
pbp_2023 %>% 
  filter(action=="REBOUND", period== 4) 
filte4(type="OFF")
filter()
```

```{r}

```




```{r}
# q1 which big ten team had the most steals in the first quarter?
wbb_pbp <- pbp_2023 %>% 
  #group_by(team,action,type,period) %>% 
  #summarize(total = n()) %>%
  filter(str_detect(conference,"Big Ten")) %>% 
  filter(str_detect(type, "STEAL")) %>% 
  filter(str_detect(period, "1"))  %>% 
group_by(team) %>% 
summarize(total_steals=n()) %>% 
  arrange(desc(total_steals))
```
**A1** Ohio State led the Big Ten in steals with 406 total steals and 11.3 per game, but their data was not featured in the data frame provided. However, Maryland had 192 steals in the first quarter, which led the conference.

```{r}

```





```{r}
# question #2 
# Which team forced the most steals in the fourth quarter all season?
 #group_by(period,team,conference) %>%
  #summarize()
fourq_steals <- pbp_2023 %>%
  filter(str_detect(type, "STEAL")) %>%
  filter(str_detect(period,"4")) %>%
group_by(team)%>%
summarize(total_steals=n()) %>%
  arrange(desc(total_steals))
```

```{r}
niagara_wbb <- pbp_2023  %>%
filter(str_detect(type,"STEAL"))%>%
filter(str_detect(team,"Niagara"))%>%
filter(str_detect(period,"4")) %>%
group_by(team)%>%
summarize(total_steals=n()) %>%
  arrange(desc(total_steals))
```
**A2** The Terps finished 19th in the country in steals, but led Division 1 with 158 steals in the fourth quarter. Niagara led the NCAA in steals with 15.2 per game and 472 total -- 120 of them in the final frame. Maryland's ability to force turnovers could have a played in a their first Elite Eight appearance since 2015. 

```{r}
# question #3
# Which team grabbed the most rebounds in the fourth quarter?
rebounds_wbb <- pbp_2023  %>%
filter(str_detect(action,"REBOUND")) %>%
filter(str_detect(period, "4")) %>%
group_by(team)%>%
summarize(total_rebounds=n())%>%
  arrange(desc(total_rebounds))
```
**A3** Maryland grabbed the most rebounds in the fourth quarter with 612.

```{r}
# question 4 
# which of the top 5 Big Ten teamw missed the most free throws in the fourth quarter under 30 seconds?
fthrows_wbb <- pbp_2023 %>%
filter(str_detect(type,"FT"))%>%
filter(str_detect(action,"MISS"))%>%
filter(str_detect(period,"4"))%>%
filter(str_detect(conference,"Big Ten"))%>%
filter(str_detect(team,"Wisconsin"))%>%
filter(str_detect(team,"Maryland"))%>%
filter(str_detect(team, "Ohio State"))%>%
filter(str_detect(team,"Michigan"))%>%
filter(stt_detect(seconds, "<30"))%>%

```


```{r}
# question 5
# which conference made the most free throws in the fourth quarter?
teamfts_wbb <- pbp_2023 %>%
filter(str_detect(conference,"Big 12"))%>%
filter(str_detect(action,"GOOD"))%>%
filter(str_detect(type,"FT"))%>%
group_by(conference)%>%
summarize(total_layups=n())%>%
  arrange(desc(total_layups))
```
**A5** 

```{r}
# question 6
# who are the top five teams with the most offensive rebounds in the third quarter and what did the results show?
oboards_wbb <- pbp_2023 %>%
filter(str_detect(action,"REBOUND")) %>%
filter(str_detect(type,"OFF"))%>%
group_by(team) %>%
summarize(total_orebs=n())%>%
arrange(desc(total_orebs))
```
**A6**The top five teams in offensive rebounds are UMD, Troy, Tennessee,Texas, and Memphis. Only three teams (UMD,Tennessee,Texas) made it to the NCAA Tournament. It's quite surprising Maryland has 240 more rebounds than Tennessee because they didn't posses great size this season. Tennessee guard Jordan Horston was fifth in the SEC with five rebounds a game, while the Terps didn't have in the conference's top 10 ranks.
```{r}
# question 7
# how many points three pointers did Brinae Alexander and Alex Giannaros make in the third quarter all season?
umd_alexander <- pbp_2023%>%
filter(str_detect(team,"Maryland"))%>%
filter(str_detect(player, "05")) %>%
filter(str_detect(type,"3PTR")) %>%
filter(str_detect(action,"GOOD")) %>%
filter(str_detect(period,"3")) %>%
filter(str_detect(team,"Boston U"))%>%
filter(str_detect(player, "10")) %>%
filter(str_detect(type,"3PTR")) %>%
filter(str_detect(action,"GOOD")) %>%
group_by(player)%>%
summarize(alexander_threes=n())%>%
  arrange(desc(alexander_threes))
```
**A7**I want to compare and see where Alexander ranks amongst the top best shooter in the country.


```{r}
# question 8
# which team committed the most fouls in the fourth quarter this season?
fouls_total <- pbp_2023 %>%
filter(str_detect(action,"FOUL")) %>%
filter(str_detect(period,"4")) %>%
group_by(team)%>%
summarize(total_fouls=n())%>%
  arrange(desc(total_fouls))
```
**A9** This season, Maryland had the most fourth quarter fouls with 364. Only three out of the first ten entries are power five schools. 

```{r}
# question 9
# which team missed the most free throws in the fourth quarter?
fourq_fts <- pbp_2023%>%
filter(str_detect(action,"MISS"))%>%
filter(str_detect(type,"FT"))%>%
filter(str_detect(period,"4"))%>%
group_by(team)%>%
summarize(total_fts=n())%>%
  arrange(desc(total_fts))
```
**A9** East Carolina and James Madison were the only teams in the top 10 in missed fourth quarter free throws to win their conference championships. If other teams made strides in this area,they could have added to their win total.
```

